type Payment @entity {
  id: ID!
  contractAddress: Bytes!
  tokenAddress: Bytes
  to: Bytes!
  from: Bytes!
  reference: Bytes!
  block: Int!
  timestamp: Int!
  txHash: Bytes!
  gasUsed: BigInt!
  gasPrice: BigInt!
  amount: BigDecimal!

  # fee values
  feeAmount: BigDecimal
  feeAddress: Bytes

  # conversion values
  currency: Bytes
  amountInCrypto: BigDecimal
  feeAmountInCrypto: BigDecimal
  maxRateTimespan: Int
}

enum EscrowState {
  inEscrow
  inEmergency
  inFrozen
  closed
}

type Escrow @entity {
  id: ID!
  contractAddress: Bytes!
  reference: Bytes!
  creationBlock: Int!
  creationTimestamp: Int!
  escrowState: EscrowState!
  tokenAddress: Bytes!
  amount: BigDecimal!
  feeAmount: BigDecimal!
  feeAddress: Bytes!
  payer: Bytes!
  payee: Bytes
  events: [EscrowEvent!] @derivedFrom(field: "escrow")
}

enum EventType {
  initializeEmergencyClaim
  revertEmergencyClaim
  freezeEscrow
  closeEscrow
}

type EscrowEvent @entity {
  id: ID!
  contractAddress: Bytes!
  reference: Bytes!
  escrow: Escrow!
  block: Int!
  timestamp: Int!
  txHash: Bytes!
  eventType: EventType!
  from: Bytes!
  gasUsed: BigInt!
  gasPrice: BigInt!
}
